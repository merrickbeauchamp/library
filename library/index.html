
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ID Scan: Student</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
  </head>

  <body>
    <main>
      <div style="position: fixed; 
  top: 50%;
  left: 50%;
  
  transform: translate(-50%, -50%);">
        <h1 style="font-size: 85px; margin-bottom: 0px">Scan ID Card Please</h1><br>
        <h2 id="text" style="margin: auto; text-align: center; font-size: 50px"></h2>
      </div>
      <input style="height:0px;width:0px" id="textbox" type="text" autofocus="autofocus" />
    </main>
    <script>
      const text = document.getElementById("text")
      textbox.addEventListener('input', async () => {
        const ding = new Audio("./ding.mp3")
        const beep = new Audio("./beep.mp3")
        if (textbox.value.length == 7) {
          text.innerHTML = "Loading..."
          let res = await fetch("https://library-api.merrickbeaucha2.repl.co/scan", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              "id": textbox.value
            })
          })
          let data = await res.json()
          if (data.success) {
            if (data.blocked) {
              text.innerHTML = "You are blocked from the library."
              beep.play()
            } else {
              if (data.full) {
                beep.play()
                text.innerHTML = "Library is full!"
              } else {
                if (data.entry) {
                  ding.play()
                  text.innerHTML = "Welcome"

                } else {
                  ding.play()
                  text.innerHTML = "Goodbye"

                }
              }
            }
          }
          textbox.value = ""
        }
      })

    </script>
  </body>

</html>